<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Q-SFTP File Browser</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/static/style.css">
</head>

<body data-theme="dark">

    <!-- Header -->
    <header class="main-header">
        <h1 class="header-title">Q-SFTP File Browser</h1>
        <div class="header-actions">
            {% if role == 'Administrator' %}
            <a href="/admin" class="btn-header" style="text-decoration: none; color: inherit;">üîê Admin Panel</a>
            {% endif %}
            <button class="btn-header">Transfer Manager</button>
            <span class="welcome-text">Welcome, {{ username }}</span>
            <button class="btn-logout" onclick="disconnectFromServer()">Logout</button>
            <div class="theme-toggles">
                <button class="theme-pill" onclick="setTheme('auto')">Auto</button>
                <button class="theme-pill" onclick="setTheme('light')">Light</button>
                <button class="theme-pill active" onclick="setTheme('dark')">Dark</button>
            </div>
        </div>
    </header>

    <!-- Breadcrumb -->
    <div class="breadcrumb-bar">
        <span class="breadcrumb-link" id="current-path-display">Root</span>
    </div>

    <!-- Main Content -->
    <main class="dashboard-main">
        <!-- Action Cards Grid -->
        <div class="card-grid">
            <!-- Upload File Card -->
            <div class="action-card">
                <h3 class="card-title">Upload File</h3>
                <div class="upload-dropzone" id="upload-drop-zone"
                    onclick="document.getElementById('file-input').click()">
                    <p>Drop files here</p>
                    <small>or click to choose. Files will upload<br>with progress and can be canceled.</small>
                </div>
                <input type="file" id="file-input" multiple style="display:none;">
                <button class="btn-primary" onclick="document.getElementById('file-input').click()">Choose File</button>
            </div>

            <!-- Create Directory Card -->
            <div class="action-card">
                <h3 class="card-title">Create Directory</h3>
                <input type="text" id="new-dir-name" class="form-input" placeholder="New directory name">
                <button class="btn-primary" onclick="createDirectory()">Create</button>
            </div>

            <!-- Transfer Speed Settings Card -->
            <div class="action-card">
                <h3 class="card-title">Transfer Speed Settings</h3>
                <select id="speed-limit" class="form-select">
                    <option value="0">No Limit</option>
                    <option value="1024">1 MB/s</option>
                    <option value="5120">5 MB/s</option>
                    <option value="10240">10 MB/s</option>
                </select>
                <button class="btn-primary" onclick="setSpeedLimit()">Set Speed</button>
                <p class="speed-status">Current limit: <span id="current-speed">No Limit</span></p>
            </div>
        </div>

        <!-- Settings Row -->
        <div class="settings-row">
            <h3 class="settings-title">Settings</h3>
            <label class="setting-item">
                <span>File Integrity Verification</span>
                <input type="checkbox" id="integrity-check" checked>
            </label>
        </div>

        <!-- Data Table -->
        <div class="data-table-container">
            <h3 class="table-title" id="table-title">Contents of: /</h3>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Type</th>
                        <th>Size</th>
                        <th>Modified</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="file-table-body">
                    <!-- JS populates this -->
                    <tr>
                        <td colspan="5" class="loading-cell"><i class="fa-solid fa-circle-notch fa-spin"></i> Loading...
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </main>

    <!-- Upload Progress (Top Floating) -->
    <div id="upload-progress-container" class="upload-progress-popup hidden">
        <div class="progress-info">
            <span id="upload-filename" class="font-mono">filename.ext</span>
            <div class="progress-track">
                <div id="upload-bar" class="progress-fill" style="width: 0%"></div>
            </div>
        </div>
        <button id="btn-cancel-upload" class="btn-cancel">Cancel</button>
    </div>

    <!-- Upload Complete Toast (Bottom Right) -->
    <div id="upload-complete-toast" class="toast-notification hidden">
        <div class="toast-content">
            <h4>Upload complete</h4>
            <p id="toast-filename">filename.ext</p>
        </div>
        <button class="toast-close" onclick="closeToast()">
            <i class="fa-solid fa-xmark"></i>
        </button>
    </div>

    <script src="/static/app.js"></script>
</body>

</html>